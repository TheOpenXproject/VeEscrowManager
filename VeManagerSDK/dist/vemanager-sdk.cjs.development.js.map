{"version":3,"file":"vemanager-sdk.cjs.development.js","sources":["../src/VeManagerSdk.ts"],"sourcesContent":["// @ts-ignore\nconst { ethers } = require(\"ethers\");\n\nexport class VeManagerSDK {\n\n\taddressesMapping\n\tveManagerAddr\n\n\tconstructor(addressesMapping, veManagerAddr){\n\t\tthis.addressesMapping = addressesMapping\n\t\tthis.veManagerAddr = veManagerAddr\n\t\treturn\n\t}\n\n\n    public getContractByAddress(address){\n    \treturn this.addressesMapping[address]\n    }\n\n    public encodeBatchedTx(targets, functionCalls, arguements){\n    \tvar encodedCallsArray = []\n    \tfor (var i = 0; i < targets.length; i++) {\n    \t\tlet ContractInstance = this.getContractByAddress(targets[i])\n    \t\t\tconst frag = ethers.utils.Fragment.from(functionCalls[i])\n\t\t\t\tconst iface = ContractInstance.interface\n\t\t\t\tencodedCallsArray.push(iface.encodeFunctionData(frag, arguements[i]));\n    \t}\n    \treturn encodedCallsArray;\n    }\n\n    public getDecodedTx(targets, encodedCalls){\n    \tvar callsObject = []\n    \tfor (var i = 0; i < targets.length; i++) {\n    \t\tlet ContractInstance = this.getContractByAddress(targets[i])\n\t\t\tlet functionSig = encodedCalls[i].slice(0,10)\n\t\t\tvar frag = null\n\t\t\ttry {\n\t\t\t\tfrag = ContractInstance.interface.getFunction(functionSig)\n\t\t\t}catch{\n\t\t\t\tconsole.log(\"ERROR decoding tx make sure abi loaded in the addressMapping.\")\n\t\t\t}\n\n\t\t\tvar txInputParsed = ContractInstance.interface.decodeFunctionData(frag, encodedCalls[i])\n\t\t\tlet tx = {\n\t\t\t\ttarget: targets[i],\n\t\t\t\tname: frag.name,\n\t\t\t\tcall: encodedCalls[i],\n\t\t\t\ttxInput: txInputParsed,\n\t\t\t\tfunctionSig: functionSig,\n\t\t\t}\n\t\t\tcallsObject.push(tx)\n\n\n    \t}\n    \treturn callsObject;\n    }\n\n    public getRawEncodedTx(targetsArray, functionCallsBytesArray, save){\n    \tconst frag = ethers.utils.Fragment.from(\"function execute(address[] targets, bytes[] calls, bool save)\")\n    \tlet ContractInstance = this.getContractByAddress(this.veManagerAddr)\n\n\t\tconst iface = ContractInstance.interface\n\t\treturn iface.encodeFunctionData(frag, [targetsArray, functionCallsBytesArray , save]);\n    }\n\n    public getRawDecodedTx(call){\n    \t\tconst decodedRawCall = this.getDecodedTx([this.veManagerAddr], [call])\n    \t\tvar decodedCalls = []\n    \t    console.log(decodedRawCall[0]);\n\n    \t\tfor (var i = 0; i < decodedRawCall[0].txInput.calls.length; i++) {\n    \t\t\tconsole.log(decodedRawCall[0].txInput.targets[i])\n    \t\t\tconsole.log(decodedRawCall[0].txInput.calls[i])\n    \t\t\tvar decodedCall = this.getDecodedTx([decodedRawCall[0].txInput.targets[i]], [decodedRawCall[0].txInput.calls[i]])\n    \t\t\tdecodedCalls.push(decodedCall)\n    \t\t}\n\n    \t    return decodedCalls\n\n    }\n\n}"],"names":["require","ethers","VeManagerSDK","addressesMapping","veManagerAddr","getContractByAddress","address","encodeBatchedTx","targets","functionCalls","arguements","encodedCallsArray","i","length","ContractInstance","frag","utils","Fragment","from","iface","push","encodeFunctionData","getDecodedTx","encodedCalls","callsObject","functionSig","slice","getFunction","console","log","txInputParsed","decodeFunctionData","tx","target","name","call","txInput","getRawEncodedTx","targetsArray","functionCallsBytesArray","save","getRawDecodedTx","decodedRawCall","decodedCalls","calls","decodedCall"],"mappings":"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"}