{"version":3,"file":"vemanager-sdk.cjs.production.min.js","sources":["../src/VeManagerSdk.ts"],"sourcesContent":["// @ts-ignore\nconst { ethers } = require(\"ethers\");\n\nexport class VeManagerSDK {\n\n\taddressesMapping\n\tveManagerAddr\n\n\tconstructor(addressesMapping, veManagerAddr){\n\t\tthis.addressesMapping = addressesMapping\n\t\tthis.veManagerAddr = veManagerAddr\n\t\treturn\n\t}\n\n\n    public getContractByAddress(address){\n    \treturn this.addressesMapping[address]\n    }\n\n    public encodeBatchedTx(targets, functionCalls, arguements){\n    \tvar encodedCallsArray = []\n    \tfor (var i = 0; i < targets.length; i++) {\n    \t\tlet ContractInstance = this.getContractByAddress(targets[i])\n    \t\t\tconst frag = ethers.utils.Fragment.from(functionCalls[i])\n\t\t\t\tconst iface = ContractInstance.interface\n\t\t\t\tencodedCallsArray.push(iface.encodeFunctionData(frag, arguements[i]));\n    \t}\n    \treturn encodedCallsArray;\n    }\n\n    public getDecodedTx(targets, encodedCalls){\n    \tvar callsObject = []\n    \tfor (var i = 0; i < targets.length; i++) {\n    \t\tlet ContractInstance = this.getContractByAddress(targets[i])\n\t\t\tlet functionSig = encodedCalls[i].slice(0,10)\n\t\t\tvar frag = null\n\t\t\ttry {\n\t\t\t\tfrag = ContractInstance.interface.getFunction(functionSig)\n\t\t\t}catch{\n\t\t\t\tconsole.log(\"ERROR decoding tx make sure abi loaded in the addressMapping.\")\n\t\t\t}\n\n\t\t\tvar txInputParsed = ContractInstance.interface.decodeFunctionData(frag, encodedCalls[i])\n\t\t\tlet tx = {\n\t\t\t\ttarget: targets[i],\n\t\t\t\tname: frag.name,\n\t\t\t\tcall: encodedCalls[i],\n\t\t\t\ttxInput: txInputParsed,\n\t\t\t\tfunctionSig: functionSig,\n\t\t\t}\n\t\t\tcallsObject.push(tx)\n\n\n    \t}\n    \treturn callsObject;\n    }\n\n    public getRawEncodedTx(targetsArray, functionCallsBytesArray, save){\n    \tconst frag = ethers.utils.Fragment.from(\"function execute(address[] targets, bytes[] calls, bool save)\")\n    \tlet ContractInstance = this.getContractByAddress(this.veManagerAddr)\n\n\t\tconst iface = ContractInstance.interface\n\t\treturn iface.encodeFunctionData(frag, [targetsArray, functionCallsBytesArray , save]);\n    }\n\n    public getRawDecodedTx(call){\n    \t\tconst decodedRawCall = this.getDecodedTx([this.veManagerAddr], [call])\n    \t\tvar decodedCalls = []\n    \t    console.log(decodedRawCall[0]);\n\n    \t\tfor (var i = 0; i < decodedRawCall[0].txInput.calls.length; i++) {\n    \t\t\tconsole.log(decodedRawCall[0].txInput.targets[i])\n    \t\t\tconsole.log(decodedRawCall[0].txInput.calls[i])\n    \t\t\tvar decodedCall = this.getDecodedTx([decodedRawCall[0].txInput.targets[i]], [decodedRawCall[0].txInput.calls[i]])\n    \t\t\tdecodedCalls.push(decodedCall)\n    \t\t}\n\n    \t    return decodedCalls\n\n    }\n\n}"],"names":["ethers","require","addressesMapping","veManagerAddr","this","_proto","getContractByAddress","address","encodeBatchedTx","targets","functionCalls","arguements","encodedCallsArray","i","length","ContractInstance","frag","utils","Fragment","from","push","encodeFunctionData","getDecodedTx","encodedCalls","callsObject","functionSig","slice","getFunction","console","log","txInputParsed","decodeFunctionData","target","name","call","txInput","getRawEncodedTx","targetsArray","functionCallsBytesArray","save","getRawDecodedTx","decodedRawCall","decodedCalls","calls","decodedCall"],"mappings":"oEACA,IAAQA,EAAWC,QAAQ,UAAnBD,uCAOP,WAAYE,EAAkBC,GAC7BC,KAAKF,iBAAmBA,EACxBE,KAAKD,cAAgBA,EAErB,kBAmEG,OAnEHE,EAGSC,qBAAA,SAAqBC,GAC3B,OAAOH,KAAKF,iBAAiBK,IAC7BF,EAEMG,gBAAA,SAAgBC,EAASC,EAAeC,GAE9C,IADA,IAAIC,EAAoB,GACfC,EAAI,EAAGA,EAAIJ,EAAQK,OAAQD,IAAK,CACxC,IAAIE,EAAmBX,KAAKE,qBAAqBG,EAAQI,IAClDG,EAAOhB,EAAOiB,MAAMC,SAASC,KAAKT,EAAcG,IAEzDD,EAAkBQ,KADJL,YACeM,mBAAmBL,EAAML,EAAWE,KAEhE,OAAOD,GACPP,EAEMiB,aAAA,SAAab,EAASc,GAE5B,IADA,IAAIC,EAAc,GACTX,EAAI,EAAGA,EAAIJ,EAAQK,OAAQD,IAAK,CACxC,IAAIE,EAAmBX,KAAKE,qBAAqBG,EAAQI,IACxDY,EAAcF,EAAaV,GAAGa,MAAM,EAAE,IACtCV,EAAO,KACX,IACCA,EAAOD,YAA2BY,YAAYF,GAC9C,SACAG,QAAQC,IAAI,iEAGb,IAAIC,EAAgBf,YAA2BgB,mBAAmBf,EAAMO,EAAaV,IAQrFW,EAAYJ,KAPH,CACRY,OAAQvB,EAAQI,GAChBoB,KAAMjB,EAAKiB,KACXC,KAAMX,EAAaV,GACnBsB,QAASL,EACTL,YAAaA,IAMZ,OAAOD,GACPnB,EAEM+B,gBAAA,SAAgBC,EAAcC,EAAyBC,GAC7D,IAAMvB,EAAOhB,EAAOiB,MAAMC,SAASC,KAAK,iEAI3C,OAH0Bf,KAAKE,qBAAqBF,KAAKD,yBAG5CkB,mBAAmBL,EAAM,CAACqB,EAAcC,EAA0BC,KAC5ElC,EAEMmC,gBAAA,SAAgBN,GACrB,IAAMO,EAAiBrC,KAAKkB,aAAa,CAAClB,KAAKD,eAAgB,CAAC+B,IAC5DQ,EAAe,GAChBd,QAAQC,IAAIY,EAAe,IAE9B,IAAK,IAAI5B,EAAI,EAAGA,EAAI4B,EAAe,GAAGN,QAAQQ,MAAM7B,OAAQD,IAAK,CAChEe,QAAQC,IAAIY,EAAe,GAAGN,QAAQ1B,QAAQI,IAC9Ce,QAAQC,IAAIY,EAAe,GAAGN,QAAQQ,MAAM9B,IAC5C,IAAI+B,EAAcxC,KAAKkB,aAAa,CAACmB,EAAe,GAAGN,QAAQ1B,QAAQI,IAAK,CAAC4B,EAAe,GAAGN,QAAQQ,MAAM9B,KAC7G6B,EAAatB,KAAKwB,GAGhB,OAAOF"}